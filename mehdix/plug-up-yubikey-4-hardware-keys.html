<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>کارت هوشمند - مهدی صادقی</title>
    <link rel="icon" type="image/png" sizes="96x96" href="/static/img/mira.png">

    <!-- Bootstrap -->
    <link href="/static/theme/maira/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/theme/maira/css/maira.css" rel="stylesheet">

    <link href="/static/theme/maira/css/font-awesome.min.css" rel="stylesheet">
    <link type="text/css" rel="stylesheet" href="https://cdn.rawgit.com/rastikerdar/vazir-font/v10.0.0-beta/dist/font-face.css">
    <link type="text/css" rel="stylesheet" href="https://cdn.rawgit.com/rastikerdar/shabnam-font/v1.1.0/dist/font-face.css">
    <link type="text/css" rel="stylesheet" href="https://cdn.rawgit.com/rastikerdar/sahel-font/v1.0.0-alpha9/dist/font-face.css">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>

    <nav class="navbar navbar-default navbar-transparent navbar-fixed-top navbar-burger" color-on-scroll="200">
        <!-- if you want to keep the navbar hidden you can add this class to the navbar "navbar-burger"-->
        <div class="container">
            <div class="navbar-header">
                <button id="menu-toggle" type="button" class="navbar-toggle" data-toggle="collapse" data-target="#example">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar bar1"></span>
                    <span class="icon-bar bar2"></span>
                    <span class="icon-bar bar3"></span>
                </button>
                <a href="/mehdix" class="navbar-brand">
                    مهدی صادقی
                </a>
            </div>
            <div class="collapse navbar-collapse">
                <ul class="nav navbar-nav navbar-right navbar-uppercase">
                    
                    <li class="dropdown rtl">
                        <a href="#category" class="dropdown-toggle" data-toggle="dropdown">
                            <i class="fa fa-angle-down"></i>
                            category
                            
                        </a>
                        <ul class="dropdown-menu dropdown-danger">
                        
                            <li>
                                <a href="/mehdix/category/jekyll/">jekyll</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/category/ابزارها/">ابزارها</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/category/اتوماسیون/">اتوماسیون</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/category/امنیت/">امنیت</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/category/بهره‌وری/">بهره‌وری</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/category/تفریح/">تفریح</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/category/جامعه/">جامعه</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/category/جکیل/">جکیل</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/category/حساب/">حساب</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/category/ذن/">ذن</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/category/شبکه/">شبکه</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/category/فضا/">فضا</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/category/لینوکس/">لینوکس</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/category/متادیتا/">متادیتا</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/category/مشارکت/">مشارکت</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/category/وب/">وب</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/category/پروژه/">پروژه</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/category/کتاب/">کتاب</a>
                            </li>
                        
                        </ul>
                    </li>
                        
                    <li class="dropdown rtl">
                        <a href="#tags" class="dropdown-toggle" data-toggle="dropdown">
                            <i class="fa fa-angle-down"></i>
                            tags
                            
                        </a>
                        <ul class="dropdown-menu dropdown-danger">
                        
                            <li>
                                <a href="/mehdix/tags/0MQ/">0MQ</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/archlinux/">archlinux</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/atom/">atom</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/bookmark/">bookmark</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/bot/">bot</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/chromium/">chromium</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/counter-style/">counter-style</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/css/">css</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/data/">data</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/extension/">extension</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/gnome/">gnome</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/gnome-shell/">gnome-shell</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/GnuPG/">GnuPG</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/gtk/">gtk</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/Hintjens/">Hintjens</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/https/">https</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/id/">id</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/inode/">inode</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/irc/">irc</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/jekyll/">jekyll</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/kramdown/">kramdown</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/list-style-type/">list-style-type</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/maktoob/">maktoob</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/markdown/">markdown</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/markup/">markup</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/pagination/">pagination</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/permission/">permission</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/Pieter/">Pieter</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/RIP/">RIP</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/rss/">rss</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/rtl/">rtl</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/SaaghiBot/">SaaghiBot</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/screen/">screen</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/smartcard/">smartcard</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/ssl/">ssl</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/telegram/">telegram</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/TLS/">TLS</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/umask/">umask</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/yaml/">yaml</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/yubikey/">yubikey</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/zen/">zen</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/ZMQ/">ZMQ</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/آرم/">آرم</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/آرچ/">آرچ</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/آزاد/">آزاد</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/ابجد/">ابجد</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/اتانازی/">اتانازی</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/اتوماسیون/">اتوماسیون</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/اجتماعی/">اجتماعی</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/استیل/">استیل</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/اسمارت‌کارت/">اسمارت‌کارت</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/اسکرین/">اسکرین</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/اطلاعات/">اطلاعات</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/افزونه/">افزونه</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/امنیت/">امنیت</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/اندازه‌گیری/">اندازه‌گیری</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/اوپن‌سورس/">اوپن‌سورس</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/ایران/">ایران</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/ایمیل/">ایمیل</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/بات/">بات</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/باگ/">باگ</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/برچسب/">برچسب</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/بورد/">بورد</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/بوکمارک/">بوکمارک</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/تقلب/">تقلب</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/تلفظ/">تلفظ</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/تلگرام/">تلگرام</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/تگ/">تگ</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/جکیل/">جکیل</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/حق/">حق</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/خوراک/">خوراک</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/خیام/">خیام</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/دسترسی/">دسترسی</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/دقت/">دقت</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/دیتا/">دیتا</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/ذن/">ذن</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/رایگان/">رایگان</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/رباعی/">رباعی</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/رمز/">رمز</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/رمزنگاری/">رمزنگاری</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/زوزه/">زوزه</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/سازوکار/">سازوکار</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/ساقی/">ساقی</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/سخت‌افزار/">سخت‌افزار</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/سرگرمی/">سرگرمی</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/سوزه/">سوزه</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/شبکه‌/">شبکه‌</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/شماره‌گذاری/">شماره‌گذاری</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/شکرگزاری/">شکرگزاری</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/صفحه‌بندی/">صفحه‌بندی</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/عدد/">عدد</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/فایرفاکس/">فایرفاکس</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/فایل/">فایل</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/فرهنگ/">فرهنگ</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/فضا/">فضا</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/قانون/">قانون</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/قفل/">قفل</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/قلاب‌وب/">قلاب‌وب</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/لینوکس/">لینوکس</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/لینک/">لینک</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/متادیتا/">متادیتا</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/محاسبه/">محاسبه</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/مرگ/">مرگ</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/مزاحمت/">مزاحمت</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/مشارکت/">مشارکت</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/مطالعه/">مطالعه</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/مکتوب/">مکتوب</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/نوم/">نوم</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/هابی/">هابی</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/همکاری/">همکاری</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/هکر/">هکر</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/وب/">وب</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/وبلاگ/">وبلاگ</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/ورکر/">ورکر</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/پایان‌نامه/">پایان‌نامه</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/پایتون/">پایتون</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/پلاگین/">پلاگین</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/پچ/">پچ</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/پیگیری/">پیگیری</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/چت/">چت</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/چیپ/">چیپ</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/کتاب/">کتاب</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/کرومیوم/">کرومیوم</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/گنوم/">گنوم</a>
                            </li>
                        
                            <li>
                                <a href="/mehdix/tags/گواهینامه/">گواهینامه</a>
                            </li>
                        
                        </ul>
                    </li>
                        

                    
                    <li class="dropdown">
                        <a href="#social" class="dropdown-toggle" data-toggle="dropdown">
                            <i class="fa fa-share-alt"></i> Socials
                        </a>
                        <ul class="dropdown-menu dropdown-danger">
                            
                            <li>
                                <a href="https://twitter.com/Twitter_UserName"><i class="fa fa-twitter"></i> twitter</a>
                            </li>
                            
                            <li>
                                <a href="https://github.com/GitHub_UserName"><i class="fa fa-github"></i> github</a>
                            </li>
                            
                            <li>
                                <a href="https://instagram.com/NAME"><i class="fa fa-instagram"></i> instagram</a>
                            </li>
                            
                            <li>
                                <a href="https://instagram.com/NAME"><i class="fa fa-google-plus-square"></i> google+</a>
                            </li>
                            
                            <li>
                                <a href="https://instagram.com/NAME"><i class="fa fa-facebook-square"></i> facebook</a>
                            </li>
                            
                        </ul>
                    </li>
                    
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
    </nav>

    <div class="section section-header">
        <div class="parallax filter filter-color-black">
        
            <div class="image"
                style="background-image: url('/static/img/head-2.jpg')">
            </div>
        
            <div class="container">
                <div class="content">
                    <div class="title-area">
                        <h1 class="title-modern">مهدی صادقی</h1>
                        <div class="separator line-separator">♦</div>
                        <h3>کارت هوشمند</h3>
                    </div>
                </div>
            </div>
        </div>
        <div class="btn-paging">
            <a href="#start" class="btn btn-white"><i class="fa fa-angle-down"></i></a>
        </div>
    </div>

    <div class="section" id="start">
        <div class="container">
            <div class="row">
            
            <div class="col-md-10 col-md-offset-1 rtl">
            <div class="post-content">
                <a href="/mehdix/plug-up-yubikey-4-hardware-keys.html"><h2 class="post-title">کارت هوشمند</h2></a>
                <div class="post-date"><time datetime="2016-05-22 07:30:28" itemprop="datePublished">یک‌شنبه، ۰۲&nbsp;خرداد&nbsp;۱۳۹۵</time></div>
                <div class="post-body">
                    <a name="more"></a>
<p>به تازگی دو کلید سخت‌افزاری تهیه کردم، یکی توسط دوستی به من هدیه داده شده و یکی را هم خریدم. هر دو آنها از پروتکل U2F پشتیبانی می‌کنند ولی کلید Yubikey 4 قابلیت‌های بیشتری دارد از جمله قابلیت اسمارت‌کارت که در این مقاله به آن می‌پردازم. البته من متخصص امنیت نیستم و این مطلب صرفا جنبه کاربردی دارد.</p>

<h1>چرا کلید سخت‌افزاری؟</h1>

<p>در حالت عادی ما با بک کلمه عبور و پسورد به حساب کاربری‌مان دسترسی پیدا می‌کنیم. این روش حداقل امنیت را تامین می‌کند. اگر کسی پسورد ما را بدست بیاورد به حساب ما دسترسی پیدا می‌کند. بهترین روشی که در حال حاضر برای امن‌تر کردن دسترسی به حسابها بوجود آمده است «تصدیق‌یابی دو مرحله‌ای» است. در این روش بعد از وارد کردن پسورد اصلی کاربر باید یک پسورد یکبار مصرف نیز وارد کند. این پسورد می‌تواند از طریق یک برنامه تولید شود یا از طریق تلفن یا پیامک به شماره تلفن از پیش مشخص شده فرد ارسال بشود و یا اینکه توسط یک کلید سخت‌افزاری تولید بشود. معمولا از کاربر هر سی روز یکبار این پسورد دوم پرسیده می‌شود. نکته مهم در مورد پسورد‌های یکبار مصرف اینست که اگر کسی آنها را به دست بیاورد نمی‌تواند هیچ سوءاستفاده‌ای بکند چرا که پسورد باطل شده است.</p>

<p>در صورتی که از کلید سخت‌افزاری برای اینکار استفاده شود، فقط کافیست که کلید در پورت USB وارد شده باشد. در مورد Yubikey 4 باید موقعی که مرورگر درخواست می‌کند، دگمه روی کلید لمس شود. </p>

<blockquote>
  <p>کارت هوشمند ابزاری برای پشتبیان‌گیری از کلیدهای خصوصی نیست.</p>
</blockquote>

<p>کلید سخت‌افزاری برای افرادی که از کامپیوترهای مختلفی استفاده می‌کنند یا ممکن است همواره گوشی هوشمند به همراه نداشته باشند گزینه مناسبی است. در ضمن از تغییرات نرم‌افزار گوشی هوشمند هم تاثیر نمی‌پذیرد و کار با آن ساده است. از همه اینها مهمترین برای من قابلیت انتقال کلیدهای خصوصی در فرآیند رمزنگاری به کمک کلیدهای عمومی است. در این روش من کلیدهای خصوصی‌ام را روی کلیدسخت‌افزاری منتقل می‌کنم و برنامه GnuPg کلیدهای خصوصی را همواره از روی کلید می‌خواند و نه از روی دیسک. این قابلیت کلید آنرا تبدیل به یک اسمارت‌کارت یا «کارت هوشمند» می‌کند. نکته مهمی که اینجا وجود دارد اینست که بدانیم کلید سخت‌افزاری روشی برای پشتبیان‌گیری از کلیدهای خصوصی نیست، بلکه صرفا جهت راحت‌تر کردن دسترسی به کلیدها بکار می‌رود بدون اینکه آنها را در خطر بیاندازد. چرا که امکان دانلود کردن کلید خصوصی از Yubikey 4 وجود ندارد.</p>

<blockquote>
  <p>امکان دانلود کردن کلید خصوصی از Yubikey 4 وجود ندارد.</p>
</blockquote>

<p>در تصویر زیر هر دو کلید قابل مشاهده هستند. یکی کوچکتر و شبیه سیم‌کارت و محصول شرکت <a href="http://happlink.com/products.html">Happlink</a> است. قیمتش تقریبا پنج یورو است. دیگری مشکلی رنگ و بزرگتر است بنام <a href="https://www.yubico.com/2015/11/4th-gen-yubikey-4/">Yubikey 4</a> و محصول شرکت Yubico که به گمانم معروف‌ترین شرکت تولید‌کننده کلید‌های سخت‌افزاری است. قیمت این یکی چهل یورو است.</p>

<p>{:.center}
<img src="assets/pimg/hardware-keys-2016-05-22-075322.jpg" alt="image not found" title="کلید‌های سخت‌افزاری Yubikey 4 و plug-up" /></p>

<h1>چرا رمزنگاری با کلید عمومی؟</h1>

<p>مدتهاست ایده‌ی اینکه ما ایمیل رمزنگاری شده به یکدیگر ارسال کنیم در عمل شکست خورده است. بنابراین اصلا چرا از رمزنگاری استفاده کنیم؟ پاسخ اینست که رمزنگاری عمومی برای اهداف مختلفی استفاده می‌شود من جمله امضای بسته‌های نرم‌افزاری. مثلا برای آپلود یک پکیج به یک مخزن ppa روی لانچ‌پد باید آنرا امضا کرد. همینطور برای آپلود یک پکیج به مخازن دبیان باید آنها را امضا کرد. چنانچه در کامیونیتی آنلاینی مثل آنچه در مورد دبیان وجود دارد نیز بخواهیم فعالیت کنیم باید کلید شناخته شده‌ای در  Web of Trust داشته باشیم. چرا که ما افراد را شخصا ملاقات نمی‌کنیم و تنها از طریق ایمیل و امضای دیجیتالی ما است که آنها به ما اعتماد می‌کنند. یا مثلا اگر از بیت‌کوین استفاده کنید باز هم باید با کلیدهایمان تراکنش‌ها را امضا کنیم و بدون دسترسی به کلید‌ها امکان دسترسی به منابع مالی وجود نخواهد داشت. </p>

<h1>شناساندن کلید‌ها به لینوکس</h1>

<p>قسمت اول افزودن udev rules های لازم برای شناساندن این کلید‌هاست. کافیست یک فایل جدید در مسیر <code>/etc/udev/rules.d/70-u2f.rules</code> ایجاد کنیم و محتوای زیر را به آن اضافه کنیم:</p>

<pre><code># this udev file should be used with udev 188 and newer
ACTION!="add|change", GOTO="u2f_end"

# Yubico YubiKey
KERNEL=="hidraw*", SUBSYSTEM=="hidraw", ATTRS{idVendor}=="1050", ATTRS{idProduct}=="0113|0114|0115|0116|0120|0402|0403|0406|0407|0410", TAG+="uaccess"

# Happlink (formerly Plug-Up) Security KEY
KERNEL=="hidraw*", SUBSYSTEM=="hidraw", ATTRS{idVendor}=="2581", ATTRS{idProduct}=="f1d0", TAG+="uaccess"

#  Neowave Keydo and Keydo AES
KERNEL=="hidraw*", SUBSYSTEM=="hidraw", ATTRS{idVendor}=="1e0d", ATTRS{idProduct}=="f1d0|f1ae", TAG+="uaccess"

# HyperSecu HyperFIDO
KERNEL=="hidraw*", SUBSYSTEM=="hidraw", ATTRS{idVendor}=="096e", ATTRS{idProduct}=="0880", TAG+="uaccess"

LABEL="u2f_end"
</code></pre>

<p>بعد از ریستارت دامون udev یا با ریستارت سیستم این قوانین فعال می‌شوند. مرورگر گوگل کروم به صورت پیش‌فرض از این کلیدها پشتیبانی می‌کند و نیاز به کار خاصی نیست. فایرفاکس هم مشغول پیاده‌سازی این قابلیت است. حالا می‌توان در تنظیمات امنیتی گوگل و گیت‌ها و هر سایت دیگری که از U2F پشتیبانی می‌کند و جزو کنسرسیوم fido است، کلید‌سخت‌فازاری‌مان را رجیستر کنیم و از آن برای گام دوم لاگین استفاده کنیم.</p>

<h1>تهیه پیشتیبان فیزیکی از کلیدها</h1>

<p>از اینجا به بعد ما کاری با کلید Happlink یا همان plug-up نداریم. این کلید فقط برای تولید پسورد بدرد می‌خورد و قابلیت ذخیره کلید خصوصی ندارد. البته گویا نسخه جدیدش اینکار را انجام می‌دهد ولی من قدیمی‌اش را دارم. برای اینکار ما از Yubikey 4 استفاده می‌کنیم. اولین مرحله تهیه نسخه پشتبیان از کلید خصوصی‌مان است. اگر کلیدی ندارید باید با دستور gpg --gen-key  یکی بسازید.</p>

<pre><code>gpg --armor --export &gt; pgp-public-keys.asc
gpg --armor --export-secret-keys &gt; pgp-private-keys.asc
gpg --armor --gen-revoke [your key ID] &gt; pgp-revocation.asc
</code></pre>

<p>خروجی دستورات بالا را پرینت کنید و همچنین روی یک سی‌دی رایت کنید و در جای مطمئنی نگهداری کنید. در غیر اینصورت اگر این فایل‌ها از بین بروند و یا در صورتی که بعد از انتقال آنها به کلیدسخت‌‌افزاری، کلید گم یا خراب بشود، دیگر امکان دست‌یابی به محتوای وابسته به این کلید وجود نخواهد داشت. من خروجی دستورات بالا را به QR کد تبدیل و چاپ کردم که بازگردانی آن راحت‌تر باشد. راهنمای لازم را روی <a href="https://github.com/4bitfocus/asc-key-to-qr-code">گیت‌هاب</a> پیدا می‌کنید.</p>

<h1>OpenPGP Smartcard Support</h1>

<p>برای فعال کردن قابلیت اسمارت‌کار برای اپن‌پی‌جی‌پی باید بسته‌های زیر را نصب و سرویس مربوطه را فعال کنیم:</p>

<pre><code>$ sudo pacman -S pcsc-tools, ccid, libusb-compat
$ sudo systemctl enable pcscd.serviceand
$ sudo systemctl start pcscd.service
</code></pre>

<p>اگر همه چیز درست انجام شود می‌توانیم وضعیت اسمارت‌کارتمان را چک کنیم:</p>

<pre><code># Check card status
[mehdi@x250 ~]$ gpg --card-status
Reader ...........: Yubico Yubikey 4 OTP U2F CCID 00 00
Application ID ...: XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
Version ..........: 2.1
Manufacturer .....: Yubico
Serial number ....: XXXXXXXX
Name of cardholder: [not set]
Language prefs ...: [not set]
Sex ..............: unspecified
URL of public key : [not set]
Login data .......: [not set]
Signature PIN ....: not forced
Key attributes ...: rsa2048 rsa2048 rsa2048
Max. PIN lengths .: 127 127 127
PIN retry counter : 3 0 3
Signature counter : 0
Signature key ....: [none]
Encryption key....: [none]
Authentication key: [none]
General key info..: [none]
</code></pre>

<p>ابزار دیگری نیز برای اینکار هست بنام <code>pcsc_scan</code>. حالا می‌توانیم کلیدها را روی کارت منتقل کنیم.</p>

<pre><code>[mehdi@x250 ~]$ gpg --edit-key mehdi@mehdix.ir
gpg (GnuPG) 2.1.12; Copyright (C) 2016 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Secret key is available.

sec  rsa2048/2E292C9F
     created: 2016-05-16  expires: 2017-05-16  usage: SC  
     trust: ultimate      validity: ultimate
ssb  rsa2048/82B64022
     created: 2016-05-16  expires: 2017-05-16  usage: E   
[ultimate] (1). Mehdi Sadeghi &lt;mehdi@mehdix.ir&gt;

gpg&gt;  key 1

sec  rsa2048/2E292C9F
     created: 2016-05-16  expires: 2017-05-16  usage: SC  
     trust: ultimate      validity: ultimate
ssb* rsa2048/82B64022
     created: 2016-05-16  expires: 2017-05-16  usage: E   
[ultimate] (1). Mehdi Sadeghi &lt;mehdi@mehdix.ir&gt;

gpg&gt; keytocard

Please select where to store the key:
   (1) Signature key
Your selection? 1
</code></pre>

<p>اگر هم چندین کلید داریم با تکرار دستور <code>keytocard</code> می‌توانیم همه آنها را منتقل کنیم. با این دستور اول باید پسورد کلید خصوصی را وارد کنیم بعد هم پسورد ادمین کلید را. موقع خروج هم تنظیمات را ذخیره می‌کنیم:</p>

<pre><code>gpg&gt; quit
Save changes? (y/N) y
</code></pre>

<p>پسورد ادمین پیش‌فرض یوبی‌کی <code>12345678</code> و پین پیش‌فرض آن <code>123456</code> است. با روش زیر می‌توان تنظیمات اسمارت‌کارت را تغییر داد:</p>

<pre><code>[mehdi@x250 ~]$ gpg --card-edit
gpg/card&gt; help
quit           quit this menu
admin          show admin commands
help           show this help
list           list all available data
fetch          fetch the key specified in the card URL
passwd         menu to change or unblock the PIN
verify         verify the PIN and list all data
unblock        unblock the PIN using a Reset Code
</code></pre>

<h1>نتیجه‌گیری</h1>

<p>طی این مقاله ما کلیدهای خصوصی را از روی هارددیسک منتقل کردیم به یک کلید سخت‌افزاری. موقع استفاده از GnuPG برای امضای دیجیتال یا رمزنگاری یا رمزگشایی باید کلید به کامپیوتر متصل باشد. همچنین می‌توان با آپلود کلیدهای عمومی به اینترنت در هرکجا فقط با همراه داشتن کلید سخت‌افزاری به عملیات‌های مرتبط دسترسی پیدا کرد. </p>

<p>اطلاعات بیشتر:</p>

<ol>
<li><a href="https://developers.yubico.com/PGP/Importing_keys.html">Yubikey 4 PGP Guide</a></li>
<li><a href="https://malcolmsparks.com/posts/yubikey-gpg.html">مشابه همین مقاله به انگلیسی</a></li>
</ol>
                </div>                 
                
                category: 
                <div class="post-meta">                        <a href="/mehdix/category/امنیت/">امنیت</a>                </div>
                                 
                
                tags: 
                <div class="post-meta">                        <a href="/mehdix/tags/yubikey/">yubikey</a>,                         <a href="/mehdix/tags/GnuPG/">GnuPG</a>,                         <a href="/mehdix/tags/smartcard/">smartcard</a>,                         <a href="/mehdix/tags/امنیت/">امنیت</a>,                         <a href="/mehdix/tags/رمزنگاری/">رمزنگاری</a>,                         <a href="/mehdix/tags/اسمارت‌کارت/">اسمارت‌کارت</a>                </div>
                            </div>
            <div class="separator">✻</div>
            </div>
            

            <div class="col-md-10 col-md-offset-1">
                <nav aria-label="Page navigation">
                    <ul class="pager">
                        
                        <li class="previous"><a href="/mehdix/bookmarker.html"><span aria-hidden="true">&larr;</span> بوکمارکر</a></li>
                        
                        
                        <li class="next"><a href="/mehdix/python-zen.html">python -m this <span aria-hidden="true">&rarr;</span></a></li>
                        
                    </ul>
                </nav>
            </div>
            </div>
        </div>
    </div>
  <footer class="footer footer-big footer-color-black" data-color="black">
    <div class="container">
        <div class="row">
            <div class="col-md-2 col-sm-3">
                <div class="info">
                    <h5 class="title">Company</h5>
                    <nav>
                        <ul>
                            <li>
                                <a href="/">Home</a></li>
                            <li>
                                <a href="#">Find offers</a>
                            </li>
                            <li>
                                <a href="#">Discover Projects</a>
                            </li>
                            <li>
                                <a href="#">Portfolio</a>
                            </li>
                            <li>
                                <a href="#">About me</a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
            <div class="col-md-3 col-md-offset-1 col-sm-3">
                <div class="info">
                    <h5 class="title"> Help and Support</h5>
                     <nav>
                        <ul>
                            <li>
                                <a href="your-email@domain.com">Contact me</a>
                            </li>
                            <li>
                                <a href="#">How it works</a>
                            </li>
                            <li>
                                <a href="#">Terms &amp; Conditions</a>
                            </li>
                            <li>
                                <a href="#">Policy</a>
                            </li>
                            <li>
                                <a href="#">License</a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
            <div class="col-md-3 col-sm-3">
                <div class="info">
                    <h5 class="title">Latest posts</h5>
                    <nav>
                        <ul>
                            
                        </ul>
                    </nav>
                </div>
            </div>
            <div class="col-md-2 col-md-offset-1 col-sm-3">
                <div class="info">
                    <h5 class="title">Follow me on</h5>
                    
                    <nav>
                        <ul>
                            
                            <li>
                                <a href="https://twitter.com/Twitter_UserName" class="btn btn-social btn-twitter btn-simple">
                                    <i class="fa fa-twitter"></i> twitter
                                </a>
                            </li>
                            <li>
                                <a href="https://github.com/GitHub_UserName" class="btn btn-social btn-github btn-simple">
                                    <i class="fa fa-github"></i> github
                                </a>
                            </li>
                            <li>
                                <a href="https://instagram.com/NAME" class="btn btn-social btn-instagram btn-simple">
                                    <i class="fa fa-instagram"></i> instagram
                                </a>
                            </li>
                            <li>
                                <a href="https://instagram.com/NAME" class="btn btn-social btn-google-plus-square btn-simple">
                                    <i class="fa fa-google-plus-square"></i> google+
                                </a>
                            </li>
                            <li>
                                <a href="https://instagram.com/NAME" class="btn btn-social btn-facebook-square btn-simple">
                                    <i class="fa fa-facebook-square"></i> facebook
                                </a>
                            </li>                        </ul>
                    </nav>
                    
                </div>
            </div>
        </div>
        <hr>
        <div class="copyright">
             <p>© <script> document.write(new Date().getFullYear()) </script></p>
             <p>generated by <a href="https://miraxy.github.io/">mira</a></p>
        </div>
    </div>
  </footer>


    <script src="/static/theme/maira/js/jquery.min.js"></script>
    <script src="/static/theme/maira/js/modernizr.js"></script>
    <script src="/static/theme/maira/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="/static/theme/maira/js/run.js" type="text/javascript"></script>
    <script src="/static/theme/maira/js/gaia.js" type="text/javascript"></script>
    <script src="/static/theme/maira/js/prettify/prettify.js" type="text/javascript"></script>

  </body>
</html>
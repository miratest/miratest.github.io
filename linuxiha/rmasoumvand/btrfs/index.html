<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>فایل سیستم Btrfs - آموزش لینوکس</title>
    <link rel="icon" type="image/png" sizes="96x96" href="/static/img/mira.png">

    <!-- Bootstrap -->
    <link href="/static/theme/maira/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/theme/maira/css/maira.css" rel="stylesheet">

    <link href="/static/theme/maira/css/font-awesome.min.css" rel="stylesheet">
    <link type="text/css" rel="stylesheet" href="https://cdn.rawgit.com/rastikerdar/vazir-font/v10.0.0-beta/dist/font-face.css">
    <link type="text/css" rel="stylesheet" href="https://cdn.rawgit.com/rastikerdar/shabnam-font/v1.1.0/dist/font-face.css">
    <link type="text/css" rel="stylesheet" href="https://cdn.rawgit.com/rastikerdar/sahel-font/v1.0.0-alpha9/dist/font-face.css">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>

    <nav class="navbar navbar-default navbar-transparent navbar-fixed-top navbar-burger" color-on-scroll="200">
        <!-- if you want to keep the navbar hidden you can add this class to the navbar "navbar-burger"-->
        <div class="container">
            <div class="navbar-header">
                <button id="menu-toggle" type="button" class="navbar-toggle" data-toggle="collapse" data-target="#example">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar bar1"></span>
                    <span class="icon-bar bar2"></span>
                    <span class="icon-bar bar3"></span>
                </button>
                <a href="/linuxiha" class="navbar-brand">
                    آموزش لینوکس
                </a>
            </div>
            <div class="collapse navbar-collapse">
                <ul class="nav navbar-nav navbar-right navbar-uppercase">
                    
                    <li class="dropdown rtl">
                        <a href="#author" class="dropdown-toggle" data-toggle="dropdown">
                            <i class="fa fa-angle-down"></i>
                            author
                            
                        </a>
                        <ul class="dropdown-menu dropdown-danger">
                        
                            <li>
                                <a href="/linuxiha/author/farbodgame/">farbodgame</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/author/MrNull/">MrNull</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/author/rmasoumvand/">rmasoumvand</a>
                            </li>
                        
                        </ul>
                    </li>
                        
                    <li class="dropdown rtl">
                        <a href="#categories" class="dropdown-toggle" data-toggle="dropdown">
                            <i class="fa fa-angle-down"></i>
                            categories
                            
                        </a>
                        <ul class="dropdown-menu dropdown-danger">
                        
                            <li>
                                <a href="/linuxiha/categories/vim/">vim</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/categories/آموزشی/">آموزشی</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/categories/ترمینال/">ترمینال</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/categories/سرور/">سرور</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/categories/شبکه/">شبکه</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/categories/شخصی‌سازی/">شخصی‌سازی</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/categories/پیکربندی/">پیکربندی</a>
                            </li>
                        
                        </ul>
                    </li>
                        
                    <li class="dropdown rtl">
                        <a href="#jdate" class="dropdown-toggle" data-toggle="dropdown">
                            <i class="fa fa-angle-down"></i>
                            آرشیو زمانی
                            
                        </a>
                        <ul class="dropdown-menu dropdown-danger">
                        
                            <li>
                                <a href="/linuxiha/archive/1395/05/">مرداد ۱۳۹۵</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/archive/1395/06/">شهریور ۱۳۹۵</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/archive/1395/07/">مهر ۱۳۹۵</a>
                            </li>
                        
                        </ul>
                    </li>
                        
                    <li class="dropdown rtl">
                        <a href="#tags" class="dropdown-toggle" data-toggle="dropdown">
                            <i class="fa fa-angle-down"></i>
                            tags
                            
                        </a>
                        <ul class="dropdown-menu dropdown-danger">
                        
                            <li>
                                <a href="/linuxiha/tags/asciinema/">asciinema</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/btrfs/">btrfs</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/btrfs-لینوکس/">btrfs لینوکس</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/dhcp/">dhcp</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/dhcp-لینوکس/">dhcp لینوکس</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/Google-Authenticator/">Google Authenticator</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/linux-dhcp-server/">linux dhcp server</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/linux-ftp-server/">linux ftp server</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/linux-lvm/">linux lvm</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/linux-mdadm-raid/">linux mdadm raid</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/linux-raid/">linux raid</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/lvm/">lvm</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/lvm-در-لینوکس/">lvm در لینوکس</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/mdadm-raid/">mdadm raid</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/network-file-system/">network file system</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/nfs-debina/">nfs debina</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/nfs-linux/">nfs linux</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/nfs-در-دبیان/">nfs در دبیان</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/raid-در-لینوکس/">raid در لینوکس</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/samba/">samba</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/samba-server/">samba server</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/samba-server-لینوکس/">samba server لینوکس</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/samba-لینوکس/">samba لینوکس</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/systemctl/">systemctl</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/systemd/">systemd</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/terminal/">terminal</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/tweek-tool/">tweek tool</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/two-factor-Authenticator/">two factor Authenticator</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/two-factor-ssh/">two factor ssh</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/vim/">vim</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/vimrc/">vimrc</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/vimrc-bank/">vimrc bank</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/vsftpd/">vsftpd</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/اوبونتو/">اوبونتو</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/ترمینال/">ترمینال</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/حریم‌شخصی/">حریم‌شخصی</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/سرور/">سرور</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/شبکه/">شبکه</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/شخصی‌سازی/">شخصی‌سازی</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/شخصی‌سازی-گنوم/">شخصی‌سازی گنوم</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/فایل-سیستم-btrfs/">فایل سیستم btrfs</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/پیکربندی/">پیکربندی</a>
                            </li>
                        
                            <li>
                                <a href="/linuxiha/tags/گنوم/">گنوم</a>
                            </li>
                        
                        </ul>
                    </li>
                        

                    
                    <li class="dropdown">
                        <a href="#social" class="dropdown-toggle" data-toggle="dropdown">
                            <i class="fa fa-share-alt"></i> Socials
                        </a>
                        <ul class="dropdown-menu dropdown-danger">
                            
                            <li>
                                <a href="https://twitter.com/Twitter_UserName"><i class="fa fa-twitter"></i> twitter</a>
                            </li>
                            
                            <li>
                                <a href="https://github.com/GitHub_UserName"><i class="fa fa-github"></i> github</a>
                            </li>
                            
                            <li>
                                <a href="https://instagram.com/NAME"><i class="fa fa-instagram"></i> instagram</a>
                            </li>
                            
                            <li>
                                <a href="https://instagram.com/NAME"><i class="fa fa-google-plus-square"></i> google+</a>
                            </li>
                            
                            <li>
                                <a href="https://instagram.com/NAME"><i class="fa fa-facebook-square"></i> facebook</a>
                            </li>
                            
                        </ul>
                    </li>
                    
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
    </nav>

    <div class="section section-header">
        <div class="parallax filter filter-color-black">
        
            <div class="image"
                style="background-image: url('/linux/static/images/linux-btrfs.jpeg')">
            </div>
        
            <div class="container">
                <div class="content">
                    <div class="title-area">
                        <h1 class="title-modern">آموزش لینوکس</h1>
                        <div class="separator line-separator">♦</div>
                        <h3>فایل سیستم Btrfs</h3>
                    </div>
                </div>
            </div>
        </div>
        <div class="btn-paging">
            <a href="#start" class="btn btn-white"><i class="fa fa-angle-down"></i></a>
        </div>
    </div>

    <div class="section" id="start">
        <div class="container">
            <div class="row">
            
            <div class="col-md-10 col-md-offset-1 rtl">
            <div class="post-content">
                <a href="/linuxiha/rmasoumvand/btrfs/"><h2 class="post-title">فایل سیستم Btrfs</h2></a>
                <div class="post-date"><time datetime="2016-09-08" itemprop="datePublished">پنج‌شنبه، ۱۸&nbsp;شهریور&nbsp;۱۳۹۵</time></div>
                <div class="post-body">
                    <a name="more"></a>
<p>Btrfs یا B-tree Filesystem یک فایل سیستم متن باز مبتنی بر مجوز GPL است که توسط شرکت هایی  چون لینوکس فاندیشن، فیسبوک، اینتل، فوجیتسو، ردهت، اوراکل، سوزه و ... توسعه داده می شود.</p>

<p>این فایل سیستم دیسک‌های با ظرفیت حداکثر ۱۶ اگزابایت و فایل‌های با اندازه حداکثر ۸ اگزابایت را پشتیبانی می‌کند.</p>

<p>برای نامگذاری فایل‌های ایجاد شده روی این فایل سیستم تقریباً می‌توان از هر کاراکتری جز '/' و NULL استفاده نمود.</p>

<p>برخی ‌از ویژگی‌های مهم Btrfs عبارتند از:</p>

<ul>
<li>یکپارچه سازی دیسک (Defragmention) به‌صورت آنلاین</li>
<li>تغییر اندازه پارتیشن ها (Volume) به‌صورت آنلاین</li>
<li>حدف یا اضافه نمودن دیسک های سخت به‌صورت آنلاین</li>
<li>بررسی فایل سیستم (Fsck) به‌صورت آفلاین</li>
<li>بررسی فایل‌ها و برطرف نمودن خودکار مشکلات آن‌ها به‌صورت آنلاین (Data Scrubbing)</li>
<li>پشتیبانی از RAID0 , RAID1, RAID10</li>
<li>پشتیبانی از Subvolume ها</li>
<li>فشرده سازی (Transparent Compression)</li>
<li>بررسی Checksum روی داده‌ها و Metadata</li>
<li>و …</li>
</ul>

<p>Btrfs در اکثر توزیع‌های معروف به‌صورت پیش‌فرض پشتیبانی می‌شود و برای استفاده از آن فقط می‌بایست ابزارهای مربوط به آن را در توزیع خود نصب کنیم.</p>

<ul>
<li><p>برای نصب در سیستم‌های مبتنی بر دبیان:</p>

<p>apt install btrfs-tools</p></li>
<li><p>برای نصب در سیستم‌های مبتنی بر ردهت:</p>

<p>yum install btrfs-progs</p></li>
</ul>

<p>یکی از خصوصیات جالب Btrfs این است که شما می‌توانید فایل سیستم را روی یک یا چند دیسک خام و پارتیشن‌بندی‌نشده ایجاد کنید. برای مثال نیازی به استفاده از ابزارهایی همچون fdisk برای پارتیشن بندی نیست.</p>

<p>برای مثال برای ایجاد فایل سیستم Btrfs بر روی سه دیسک sdb, sdc, sdd دستور زیر را وارد می کنیم:</p>

<pre><code>mkfs.btrfs /dev/sdb /dev/sdc /dev/sdd
</code></pre>

<p>پس از اجرای دستور فوق خروجی بصورت زیر خواهد بود:</p>

<pre>
Btrfs v3.17
See http://btrfs.wiki.kernel.org for more information.

Turning ON incompat feature 'extref': increased hardlink limit per file to 65536
adding device /dev/sdc id 2
adding device /dev/sdd id 3
fs created label (null) on /dev/sdb
    nodesize 16384 leafsize 16384 sectorsize 4096 size 24.00GiB
</pre>

<ul>
<li><strong>نکته) در صورتی که دستور mkfs.btrfs رو بدون هیچ سوییچ و همراه با چند دیسک به‌کار ببریم به‌صورت پیش‌فرض از RAID0 (Stripe)برای ذخیره سازی داده‌ها و از (Mirror) RAID1 برای ذخیره‌سازی Metadata استفاده می‌شود. مزییت این روش در این است که علاوه بر بهبود سرعت خواندن و نوشتن داده‌ها در صورتی که یکی از دیسک‌ها دچار مشکل شود به کمک Metadata می‌توانیم داده‌های از دست رفته را بازسازی کنیم.</strong></li>
</ul>

<p>اگر مایل هستید که btrfs رو تنها روی یک دیسک ایجاد کنید و یا مایل نیستید که Data و Metadata بصورت RAID ذخیره سازی شود می‌توانید از سوییچ m- بصورت زیر استفاده نمایید:</p>

<pre><code>mkfs.btrfs -m single /dev/sdb
</code></pre>

<p>همچنین در صورتی که بخواهید همین کار را با چندین دیسک انجام دهید نیز می‌توانید به‌صورت زیر عمل نمایید:</p>

<pre><code>mkfs.btrfs -m raid0 /dev/sdb /dev/sdc /dev/sdd
</code></pre>

<p>که در مثال فوق برای ذخیره‌سازی Metadata از RAID0 (Stripe) بجای RAID1 (گزینه پیشفرض) استفاده می گردد.</p>

<p>همچنین می‌توانیم نحوه ذخیره‌سازی Data و Metadata را به دلخواه خودمان تعریف کنیم. برای مثال:</p>

<pre><code>mkfs.btrfs -m raid0 -d raid1 /dev/sdb /dev/sdc /dev/sdd
</code></pre>

<p>که در مثال فوق توسط سوییچ‌های m- و d- نحوه ذخیره‌سازی مشخص گردیده است.</p>

<ul>
<li><strong>نکته) می‌توانیم از RAID10 نیز برای ذخیره‌سازی Data و Metadata استفاده کنیم اما می‌بایست توجه داشته باشید که برای استفاده از RAID10 حداقل به ۴ دیسک نیاز است.</strong></li>
</ul>

<p>برای مشاهده وضعیت فایل سیستم ایجاد شده دستور زیر را وارد می کنیم:</p>

<pre><code>btrfs filesystem show /dev/sdb
</code></pre>

<ul>
<li><strong>نکته) از آنجایی که در مثال فوق برای نشان دادن قابلیت‌های RAID در Btrfs از 3 دیسک استفاده نمودیم بنابراین برای نمایش اطلاعات فایل‌سیستم توسط دستور فوق هیچ فرقی نمی‌کند که نام کدام دیسک را اعلام کنیم چرا که هر 3 دیسک مربوط به یک فایل سیستم و در قالب یک Pool می‌باشد.</strong></li>
</ul>

<p>که خروجی آن به‌صورت زیر خواهد بود:</p>

<pre>
Label: none  uuid: f36e0a56-bcea-4637-a1e4-c9788574d84a
    Total devices 3 FS bytes used 112.00KiB
    devid    1 size 8.00GiB used 1.82GiB path /dev/sdb
    devid    2 size 8.00GiB used 827.19MiB path /dev/sdc
    devid    3 size 8.00GiB used 1.81GiB path /dev/sdd

Btrfs v3.17
</pre>

<p>پس از ایجاد فایل سیستم می‌توانیم به راحتی و توسط دستور زیر انرا Mount نماییم:</p>

<pre><code>mount /dev/sdb /mnt
</code></pre>

<p>برای مشاهده فضای مصرفی و فضای باقی‌مانده فایل سیستم دستور زیر را وارد می کنیم:</p>

<pre><code>btrfs filesystem df /mnt
</code></pre>

<p>که خروجی آن به‌صورت زیر خواهد بود:</p>

<pre>
Data, RAID0: total=2.40GiB, used=832.00KiB
Data, single: total=8.00MiB, used=0.00B
System, RAID1: total=8.00MiB, used=16.00KiB
System, single: total=4.00MiB, used=0.00B
Metadata, RAID1: total=1.00GiB, used=112.00KiB
Metadata, single: total=8.00MiB, used=0.00B
GlobalReserve, single: total=16.00MiB, used=0.00B
</pre>

<p>یکی از ویژگی‌های Btrfs قابلیت فشرده‌سازی داده‌ها می‌باشد که موجب می‌شود داده‌ها به‌صورت فشرده‌شده روی دیسک ذخیره شوند که موجب صرفه‌جویی در مصرف فضای دیسک می‌گردد. Btrfs از دو متد فشرده‌سازی zlib و lzo برای فشرده‌سازی استفاده می‌کند.</p>

<ul>
<li><strong>نکته) Btrfs بصورت پیش‌فرض از zlib برای فشرده‌سازی استفاده می کند.</strong></li>
</ul>

<p>برای فعال نمودن قابلیت فشرده‌سازی کافی است که دیسک مورد نظر را بصورت زیر Mount کنیم:</p>

<pre><code>mount -o compress=lzo /dev/sdb /mnt
</code></pre>

<p>یا</p>

<pre><code>mount -o compress=zlib /dev/sdb /mnt
</code></pre>

<p>یا</p>

<pre><code>mount -o compress /dev/sdb /mnt
</code></pre>

<p>که دستور اول با استفاده از lzo و در دستور دوم با استفاده از zlib اقدام به فشرده‌سازی داده‌ها می کند. در دستور سوم هم از گزینه پیشفرض (zlib) برای فشرده‌سازی استفاده می‌شود.</p>

<ul>
<li><strong>نکته) زمانی که یک دیسک را با قابلیت فشرده‌سازی Mount می‌کنید توجه داشته باشید که تنها داده‌هایی که از آن پس در دیسک ذخیره خواهند شد فشرده می گردند.</strong></li>
</ul>

<p>از دیگر ویژگی‌های Btrfs امکان تغییر حجم Volume ها به‌صورت آنلاین می باشد. به‌عنوان مثال دستور زیر مقدار 2G از فضای فایل سیستم mnt/ می کاهد.</p>

<pre><code>btrfs filesystem resize -2g /mnt
</code></pre>

<p>و دستور زیر مقدار 500M به فضای فایل سیستم mnt/ اضافه می‌کند.</p>

<pre><code>btrfs filesystem resize +500m /mnt
</code></pre>

<p>برای اضافه نمودن دیسک جدید به فایل‌سیستم مورد نظرمان به‌صورت زیر عمل می کنیم.</p>

<pre><code>btrfs device add /dev/sde /mnt
</code></pre>

<p>سپس دستور زیر را جهت مشاهده وضعیت فایل‌سیستم وارد می کنیم.</p>

<pre><code>btrfs filesystem show /dev/sdb
</code></pre>

<p>که خروجی آن به‌صورت زیر خواهد بود.</p>

<pre>
Label: none  uuid: f36e0a56-bcea-4637-a1e4-c9788574d84a
    Total devices 4 FS bytes used 960.00KiB
    devid    1 size 8.00GiB used 1.82GiB path /dev/sdb
    devid    2 size 8.00GiB used 827.19MiB path /dev/sdc
    devid    3 size 8.00GiB used 1.81GiB path /dev/sdd
    devid    4 size 8.00GiB used 0.00B path /dev/sde

Btrfs v3.17
</pre>

<p>همان‌طور که مشاهده می‌کنید دیسک sde به فایل‌سیستم اضافه شد با این حال در حال حاضر از فضای آن استفاده نمی‌شود. برای اینکه بتوان از فضای دیسک جدید هم استفاده نمود می‌بایست دستور زیر را وارد کنیم.</p>

<pre><code>btrfs filesystem balance /mnt
</code></pre>

<p>که پس از اجرای دستور فوق خروجی به شکل زیر خواهد بود.</p>

<pre><code>Done, had to relocate 6 out of 6 chunks
</code></pre>

<p>برای حذف یک دیسک از فایل سیستم دستور زیر را وارد می‌کنیم.</p>

<pre><code>btrfs device delete /dev/sdc /mnt
</code></pre>

<p>در صورتی که بخواهیم RAID Level را برای فایل سیستم ایجاد شده تغییر دهیم می‌توانیم به‌صورت زیر عمل کنیم.</p>

<pre><code>btrfs balance start -dconvert=raid1 -mconvert=raid1 /mnt
</code></pre>

<p>یکی دیگر از قابلیت‌های جالب در btrfs مفهومی به نام Subvolume است. در btrfs می‌توانیم در هر فایل سیستم Subvolume هایی ایجاد کنیم و سپس از این Subvolume ها Snapshot بگیریم و یا آن‌ها را به‌صورت مستقل از فایل سیستم اصلی Mount کنیم.</p>

<p>برای ایجاد یک Subvolume دستور زیر را وارد می کنیم.</p>

<pre><code>btrfs subvolume create /mnt/sv1
</code></pre>

<p>در مثال فوق یک Subvolume با نام sv1 در فایل سیستم mnt/ ایجاد گردید.</p>

<p>برای نمایش وضعیت Subvolume ها در فایل سیستم mnt/ دستور زیر را وارد می کنیم.</p>

<pre><code>btrfs subvolume list /mnt
</code></pre>

<p>که خروجی آن به‌صورت زیر خواهد بود.</p>

<pre><code>ID 272 gen 136 top level 5 path sv1
</code></pre>

<p>همانطور که مشاهده می‌کنید هر Subvolume یک ID منحصر به فرد دارد که به آن Subvolume اشاره می‌کند.</p>

<p>همچنین می‌توانیم یک Subvolume را درون Subvolume دیگری ایجاد کنیم.</p>

<pre><code>btrfs subvolume create /mnt/sv1/sv2
</code></pre>

<p>برای Mount نمودن یک Subvolume به‌صورت زیر عمل می کنیم:</p>

<p>ابتدا می‌بایست فایل‌سیستم اصلی را در صورتی که Mount می‌باشد Unmount کنیم.</p>

<pre><code>umount /mnt
</code></pre>

<p>و سپس توسط دستور زیر و به وسیله Subvolume ID آن را به‌صورت زیر Mount می کنیم.</p>

<pre><code>mount -o subvolid=272 /dev/sdb /mnt
</code></pre>

<p>که در اینجا Subvolume ID مورد نظر ما 266 است. همچنین می‌توانیم به جای استفاده از ID از نام Subvolume استفاده کنیم.</p>

<pre><code>mount -o subvol=sv1 /dev/sdb /mnt
</code></pre>

<ul>
<li><strong>نکته)‌ ID مربوط به Volume ریشه همواره 0 است.</strong></li>
</ul>

<p>برای تغییر Default Volume در زمان Mount می‌توانیم به‌صورت زیر عمل کنیم.</p>

<pre><code>btrfs subvolume set-default 266 /mnt
</code></pre>

<p>از این پس هنگام Mount نمودن فایل‌سیستم، به جای Volume ریشه Subvolume مشخص شده به‌صورت پیشفرض Mount می‌گردد.</p>

<p>برای حدف یک Subvolume دستور زیر را وارد می کنیم.</p>

<pre><code>btrfs subvolume delete /mnt/sv1
</code></pre>

<p>دستور فوق Subvolume با نام sv1 را حذف می کند.</p>

<p>یکی دیگر از امکانات مفید btrfs امکان تهیه Snapshot از Subvolume ها به‌صورت آنلاین است. توسط Snapshot ها می‌توانیم از Data های ذخیره شده در Subvolume ها کپی پشتیبان تهیه کنیم تا در مواقع لزوم Data ها را به حالت اولیه بازگردانیم.</p>

<p>برای تهیه Snapshot دستور زیر را وارد می‌کنیم.</p>

<pre><code>btrfs subvolume snapshot /mnt/sv1 /mnt/sv1_snapshot
</code></pre>

<p>توسط دستور فوق یک Snapshot با نام sv1_snapshot از sv1 تهیه شد.</p>

<p>سپس می‌توانیم این Snapshot را در مواقع لزوم مستقیماً Mount کنیم و از اطلاعات ذخیره شده استفاده کنیم.</p>

<pre><code>mount -o subvol=sv1_snapshot /dev/sdb /mnt
</code></pre>

<p>برای یکپارچه‌سازی (Defragment) فایل سیستم دستور زیر را وارد می کنیم.</p>

<pre><code>btrfs filesystem defrag /mnt
</code></pre>

<p>همچنین می توانیم توسط دستور زیر فایل‌سیستم را با قابلیت یکپارچه‌سازی خودکار Mount کنیم.</p>

<pre><code>mount -o autodefrag /dev/sdb /mnt
</code></pre>
                </div>                 
                
                categories: 
                <div class="post-meta">                        <a href="/linuxiha/categories/آموزشی/">آموزشی</a>,                         <a href="/linuxiha/categories/پیکربندی/">پیکربندی</a>                </div>
                                 
                
                tags: 
                <div class="post-meta">                        <a href="/linuxiha/tags/پیکربندی/">پیکربندی</a>,                         <a href="/linuxiha/tags/btrfs/">btrfs</a>,                         <a href="/linuxiha/tags/btrfs-لینوکس/">btrfs لینوکس</a>,                         <a href="/linuxiha/tags/فایل-سیستم-btrfs/">فایل سیستم btrfs</a>                </div>
                                 
                
                author: 
                <div class="post-meta">                        <a href="/linuxiha/author/rmasoumvand/">rmasoumvand</a>                </div>
                                 
                            </div>
            <div class="separator">✻</div>
            </div>
            

            <div class="col-md-10 col-md-offset-1">
                <nav aria-label="Page navigation">
                    <ul class="pager">
                        
                        <li class="previous"><a href="/linuxiha/mrnull/asciinema/"><span aria-hidden="true">&larr;</span> چگونه از صفحه ترمینال فیلم بگیریم؟</a></li>
                        
                        
                        <li class="next"><a href="/linuxiha/mrnull/gnome-tweak-tool/">شخصی‌سازی گنوم با Tweak Tool <span aria-hidden="true">&rarr;</span></a></li>
                        
                    </ul>
                </nav>
            </div>
            </div>
        </div>
    </div>
  <footer class="footer footer-big footer-color-black" data-color="black">
    <div class="container">
        <div class="row">
            <div class="col-md-2 col-sm-3">
                <div class="info">
                    <h5 class="title">Company</h5>
                    <nav>
                        <ul>
                            <li>
                                <a href="/">Home</a></li>
                            <li>
                                <a href="#">Find offers</a>
                            </li>
                            <li>
                                <a href="#">Discover Projects</a>
                            </li>
                            <li>
                                <a href="#">Portfolio</a>
                            </li>
                            <li>
                                <a href="#">About me</a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
            <div class="col-md-3 col-md-offset-1 col-sm-3">
                <div class="info">
                    <h5 class="title"> Help and Support</h5>
                     <nav>
                        <ul>
                            <li>
                                <a href="your-email@domain.com">Contact me</a>
                            </li>
                            <li>
                                <a href="#">How it works</a>
                            </li>
                            <li>
                                <a href="#">Terms &amp; Conditions</a>
                            </li>
                            <li>
                                <a href="#">Policy</a>
                            </li>
                            <li>
                                <a href="#">License</a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
            <div class="col-md-3 col-sm-3">
                <div class="info">
                    <h5 class="title">Latest posts</h5>
                    <nav>
                        <ul>
                            
                        </ul>
                    </nav>
                </div>
            </div>
            <div class="col-md-2 col-md-offset-1 col-sm-3">
                <div class="info">
                    <h5 class="title">Follow me on</h5>
                    
                    <nav>
                        <ul>
                            
                            <li>
                                <a href="https://twitter.com/Twitter_UserName" class="btn btn-social btn-twitter btn-simple">
                                    <i class="fa fa-twitter"></i> twitter
                                </a>
                            </li>
                            <li>
                                <a href="https://github.com/GitHub_UserName" class="btn btn-social btn-github btn-simple">
                                    <i class="fa fa-github"></i> github
                                </a>
                            </li>
                            <li>
                                <a href="https://instagram.com/NAME" class="btn btn-social btn-instagram btn-simple">
                                    <i class="fa fa-instagram"></i> instagram
                                </a>
                            </li>
                            <li>
                                <a href="https://instagram.com/NAME" class="btn btn-social btn-google-plus-square btn-simple">
                                    <i class="fa fa-google-plus-square"></i> google+
                                </a>
                            </li>
                            <li>
                                <a href="https://instagram.com/NAME" class="btn btn-social btn-facebook-square btn-simple">
                                    <i class="fa fa-facebook-square"></i> facebook
                                </a>
                            </li>                        </ul>
                    </nav>
                    
                </div>
            </div>
        </div>
        <hr>
        <div class="copyright">
             <p>© <script> document.write(new Date().getFullYear()) </script></p>
             <p>generated by <a href="https://miraxy.github.io/">mira</a></p>
        </div>
    </div>
  </footer>


    <script src="/static/theme/maira/js/jquery.min.js"></script>
    <script src="/static/theme/maira/js/modernizr.js"></script>
    <script src="/static/theme/maira/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="/static/theme/maira/js/run.js" type="text/javascript"></script>
    <script src="/static/theme/maira/js/gaia.js" type="text/javascript"></script>
    <script src="/static/theme/maira/js/prettify/prettify.js" type="text/javascript"></script>

  </body>
</html>